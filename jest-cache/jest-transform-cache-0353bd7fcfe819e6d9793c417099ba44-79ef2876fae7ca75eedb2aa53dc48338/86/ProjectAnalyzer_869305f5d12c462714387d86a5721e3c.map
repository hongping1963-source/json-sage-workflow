{"version":3,"names":["cov_2kvskf6wpa","actualCoverage","s","promises_1","require","path_1","glob_1","ProjectAnalyzer","analyzeProject","f","projectInfo","type","framework","jsonDirectories","packageJson","readPackageJson","determineProjectType","detectFramework","findJsonDirectories","error","console","content","readFile","JSON","parse","deps","dependencies","devDependencies","hasBackend","b","express","koa","fastify","nest","hasFrontend","react","vue","angular","jsonFiles","glob","ignore","Set","map","file","join","process","cwd","exports"],"sources":["C:\\Users\\hongping\\CascadeProjects\\json-sage-ai-agent\\src\\core\\ProjectAnalyzer.ts"],"sourcesContent":["import { readFile } from 'fs/promises';\r\nimport { join } from 'path';\r\nimport { glob } from 'glob';\r\n\r\ninterface ProjectInfo {\r\n    type: 'frontend' | 'backend' | 'fullstack';\r\n    framework: string;\r\n    jsonDirectories: string[];\r\n}\r\n\r\nexport class ProjectAnalyzer {\r\n    async analyzeProject(): Promise<ProjectInfo> {\r\n        const projectInfo: ProjectInfo = {\r\n            type: 'frontend',\r\n            framework: 'unknown',\r\n            jsonDirectories: []\r\n        };\r\n\r\n        try {\r\n            // 检测 package.json\r\n            const packageJson = await this.readPackageJson();\r\n            \r\n            // 分析项目类型和框架\r\n            projectInfo.type = this.determineProjectType(packageJson);\r\n            projectInfo.framework = this.detectFramework(packageJson);\r\n            \r\n            // 查找JSON文件目录\r\n            projectInfo.jsonDirectories = await this.findJsonDirectories();\r\n\r\n            return projectInfo;\r\n        } catch (error) {\r\n            console.error('Error analyzing project:', error);\r\n            return projectInfo;\r\n        }\r\n    }\r\n\r\n    private async readPackageJson() {\r\n        try {\r\n            const content = await readFile('package.json', 'utf-8');\r\n            return JSON.parse(content);\r\n        } catch (error) {\r\n            return {};\r\n        }\r\n    }\r\n\r\n    private determineProjectType(packageJson: any): 'frontend' | 'backend' | 'fullstack' {\r\n        const deps = { ...packageJson.dependencies, ...packageJson.devDependencies };\r\n        \r\n        const hasBackend = deps.express || deps.koa || deps.fastify || deps.nest;\r\n        const hasFrontend = deps.react || deps.vue || deps.angular;\r\n\r\n        if (hasBackend && hasFrontend) return 'fullstack';\r\n        if (hasBackend) return 'backend';\r\n        return 'frontend';\r\n    }\r\n\r\n    private detectFramework(packageJson: any): string {\r\n        const deps = { ...packageJson.dependencies, ...packageJson.devDependencies };\r\n        \r\n        if (deps.react) return 'react';\r\n        if (deps.vue) return 'vue';\r\n        if (deps.angular) return 'angular';\r\n        if (deps.express) return 'express';\r\n        if (deps.nest) return 'nest';\r\n        \r\n        return 'unknown';\r\n    }\r\n\r\n    private async findJsonDirectories(): Promise<string[]> {\r\n        const jsonFiles = await glob('**/*.json', {\r\n            ignore: ['node_modules/**', 'dist/**', 'build/**'],\r\n        });\r\n\r\n        return [...new Set(jsonFiles.map(file => join(process.cwd(), file)))];\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]}